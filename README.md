# Word Calendar Generator
This program creates a printable Microsoft Word .docx calendar based on a particular user entered week or month, using a .ical file provided from Google Calendar (or similar).

# WHAT DOES IT DO?

This program is useful if you have a building with many rooms being used day to day for various things (such as classes or events), and you need to track what's going on in there using a paper based calendar that you print out regularly. Yes, paper. Recycle it when you're done, at least!

This is particularly handy as printing out calendars from Google Calendar or similar will not provide enough at-a-glance information, failing to provide a customizable color coding system and not showing enough events per day. In this program, each room is given a distinct color (and row, in the case of the weekly calendar), and each event is labeled clearly where and when it is based on the color and short name given 

# Requirements

These are not hard requirements but just what the program has been tested with:

* macOS (Mojave+) or Windows (10+)

    * Linux support unknown but should work. 

* [Python](https://www.python.org/) 3.7.4 and above - Program should reasonably work without issue on newer versions. (tested on 3.8)

* Microsoft Word or any word processing program that can open docx files

* Basic knowledge of installing Python modules [(see here)](https://pip.pypa.io/en/stable/quickstart/)

# Modules Used

[python-docx](https://python-docx.readthedocs.io/en/latest/) - Used to work with docx files for use in Microsoft Word

[icalendar](https://pypi.org/project/icalendar/) - Used to grab events (sort of)

[recurring-ical-events](https://pypi.org/project/recurring-ical-events/) - Actually used to grab events since icalendar module does not support recurring events

[pytz](https://pypi.org/project/pytz/2005k/) - For timezone conversion

[holidays](https://pypi.org/project/holidays/) - Detecting holidays

# Usage

* Install all the listed modules above

```
pip install python-docx
pip install icalendar
pip install recurring-ical-events
pip install pytz
pip install holidays
```
* Make a calendar on Google Calendar, or Outlook, or any service that provides a URL to access the .ical file.
    * In the "Location" field of each event, input the room name that it is taking place in. Make sure this is something you want to enter every time you add an event. Shorthand names works as long as you pay attention in the next steps.

* Open settings.py in a text editor and edit the contents:
    
    * Set the URL of the ical file. This is provided by most calendar services in the settings for the calendar you have created.
    ``` URL = "example.com/basic.ics" ```
    * Set the timezone to be used, because the icalendar module can get confused by choices made by the calendar services sometimes
    ```USER_TIMEZONE = "America/Los_Angeles"```
    * Under RM_CLR_CODE: Set the names of the rooms, their colors, their short name, and all the names of the room that you might have entered into the "Location" field of each event in the calendar. You can put shorthard here as long as the full name of the room is the first value of each line. The last entry should always be an error.
    
    ```
    RM_CLR_CODE = [
	["Art Studio",[253,127,3],"ART",["Art Room"]],
	["Buckley Room",[252,1,7],"BUCK",["Redwood Buckley Room","Buckley Redwood Room","Redwood-Buckley Room","Buckley-Redwood Room"]],
	["Woodshop",[79,129,189],"WOOD",["Woodworking Studio","Wood Shop"] ],
	["The Garage",[16,128,64],"GARG",["Garage"]],
	["Ceramics Studio",[112,48,160],"CLAY"["Ceramics Room","Ceramics"]],
	["Science Studio",[0,0,0],"SCI",["Science Room","Science"]],
	["Theater",[252,2,255],'THTR',["Theater"]],
	["Randall Room",[151,71,6],'RNDL',["Randall"]],
	["",[0,0,0],'ERROR',[""]]        
    ]
    ```
    * Under the above list you will find the document settings. These are fairly self explanatory.
    ```
    # document properties
    PAPER_SIZE_HEIGHT = 11
    PAPER_SIZE_WIDTH = 17
    MARGIN_SIZE = .25
    FONT_CHOICE = "Arial"
    CAL_FONT_SIZE = 11
    HEADER_FONT_SIZE = 26
    TABLE_STYLE = 'Table Grid'
    WEEK_STARTS_ON = "sunday"
    ```
    * Choose holidays to have off. Custom holidays can be added here if you so chose, just [follow the documentation for the holidays module](https://pypi.org/project/holidays/). 
    ```
    import holidays
    HOLIDAYS = holidays.UnitedStates()
    ```


* Run file "main.py" via Python. Say whether or not you want to make a monthly or weekly calendar. Enter a date either in MM/DD/YYYY for week calendars or MM/YYYY for month calendars.

* Console will ask if you want to open the generated file. Enter an affirmative word (yes, y, yeah) or a negative word (no, n, nope) to decide what you want to do.

* Regardless of the last choice, the docx file generated by the program will be in the folder of the program.




